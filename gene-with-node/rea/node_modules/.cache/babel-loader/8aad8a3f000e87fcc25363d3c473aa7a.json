{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Model = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _Fieldset = require('./Fieldset');\n\nvar _Fieldset2 = _interopRequireDefault(_Fieldset);\n\nvar _inputs = require('./inputs');\n\nvar Inputs = _interopRequireWildcard(_inputs);\n\nvar _connectInput = require('./connectInput');\n\nvar _connectInput2 = _interopRequireDefault(_connectInput);\n\nvar _ValidationError = require('./ValidationError');\n\nvar _ValidationError2 = _interopRequireDefault(_ValidationError);\n\nvar _Input = require('./Input');\n\nvar _Input2 = _interopRequireDefault(_Input);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Form = function (_React$Component) {\n  _inherits(Form, _React$Component);\n\n  function Form(props, context) {\n    _classCallCheck(this, Form); // A list of input elements available on this form\n    // populated through the context by the the child inputs\n\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Form).call(this, props, context));\n\n    _this.inputs = {};\n    _this.state = {\n      preset: Object.assign({}, _this.props.preset, _this.props.suppress),\n      error: false\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      this.setState({\n        preset: Object.assign({}, nextProps.preset, nextProps.suppress)\n      });\n    }\n  }, {\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        form: this\n      };\n    }\n    /** Get all the values of the input elements in the form \"asyncronously\"\n     * and also validates the value in the process\n     */\n\n  }, {\n    key: 'serialize',\n    value: function serialize() {\n      var res = Object.assign({}, this.state.preset);\n      var inputs = [];\n      var names = [];\n      var promises = [];\n\n      for (var inp in this.inputs) {\n        var elem = this.inputs[inp];\n        names.push(inp);\n        inputs.push(elem);\n        promises.push(elem.getValue());\n      }\n\n      return Promise.all(promises).then(function (values) {\n        var promises = values.map(function (val, index) {\n          return inputs[index].validate(val);\n        });\n        return Promise.all(promises).then(function (values) {\n          values.forEach(function (val, index) {\n            if (val !== undefined) {\n              res[names[index]] = val;\n            }\n          });\n          return res;\n        });\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n      var error = this.state.error;\n\n      if (!children) {\n        children = generate(this.props.attributes, this.props.suppress);\n        children.push(_react2.default.createElement(Form.Fieldset, {\n          key: 'form__submit__',\n          label: ''\n        }, _react2.default.createElement('button', {\n          className: 'btn btn-sm btn-primary',\n          type: 'submit',\n          onClick: this._onSubmit.bind(this)\n        }, 'Save')));\n      }\n\n      return _react2.default.createElement('div', {\n        className: 'form',\n        onSubmit: this._onSubmit.bind(this)\n      }, typeof error === \"string\" && _react2.default.createElement('div', {\n        className: '.alert-danger'\n      }, error), children);\n    }\n  }, {\n    key: '_onSubmit',\n    value: function _onSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      var actionUrl = typeof this.props.action === \"function\" ? this.props.action(props) : this.props.action;\n      var method = this.props.method || (this.props.preset ? \"PUT\" : \"POST\"); // Automatically detect the form post method\n\n      this.serialize().then(function (res) {\n        var xhr = new XMLHttpRequest();\n        xhr.open(method, actionUrl);\n\n        xhr.onload = function () {\n          var response = xhr.response; // Parsing the JSON type data, checking with startsWith, as charset may also be available\n          // TODO: A good content type parser with charsets need to be implemented\n\n          if (xhr.getResponseHeader('content-type').startsWith(\"application/json\")) {\n            response = JSON.parse(response);\n          }\n\n          if (xhr.status >= 200 && xhr.status < 300) {\n            _this2.props.onSuccess && _this2.props.onSuccess(response);\n          } else if (xhr.status >= 400 && xhr.status < 500) {\n            _this2._handleError(\"Invalid server configuration. The resource could not be found.\", response);\n          } else if (xhr.status >= 500 && xhr.status < 600) {\n            _this2._handleError(\"Invalid input data\", response);\n          } else {\n            _this2._handleError(\"Unknown error. Please contact system administrator. \" + xhr.status + \"::\" + xhr.statusText, response);\n          }\n        };\n\n        xhr.onerror = function () {\n          return _this2._handleError(\"Network error\", null);\n        };\n\n        if ((typeof res === 'undefined' ? 'undefined' : _typeof(res)) === \"object\") {\n          res = JSON.stringify(res);\n        }\n\n        xhr.send(res);\n      }).catch(function (err) {\n        if (err instanceof _ValidationError2.default) {\n          _this2.setError(err.name, err.message);\n        } else {\n          console.error(\"Unknown Error\", err);\n\n          _this2.setState({\n            error: \"Unknown error\"\n          });\n        }\n      });\n    }\n  }, {\n    key: '_handleError',\n    value: function _handleError(msg, data) {\n      this.setState({\n        error: msg\n      });\n    }\n  }, {\n    key: 'getDefaultValue',\n    value: function getDefaultValue(name) {\n      return this.props.preset && this.props.preset[name];\n    }\n  }, {\n    key: 'registerInput',\n    value: function registerInput(name, element) {\n      // The name should not be registered more than once\n      if (this.inputs.hasOwnProperty(name)) {\n        console.error(\"A form input with name '\" + name + \"' is already registered.\" + \" The element you are trying to register is not going to be registered.\" + \" There shouldn't be more than one input element with the same name. In \" + \" case you are using a checkbox or a radio button make sure you incapsulate \" + \" them in a parent component and use that parent component as the input element.\");\n      } else {\n        this.inputs[name] = element;\n      }\n    }\n  }, {\n    key: 'unregisterInput',\n    value: function unregisterInput(name, element) {\n      // Unregister only if the name and element matches, trying to avoid\n      // same name regsitration error problem\n      if (this.inputs[name] === element) {\n        delete this.inputs[name];\n      }\n    }\n  }, {\n    key: 'getError',\n    value: function getError(name) {\n      return _typeof(this.state.error) === \"object\" && this.state.error[name];\n    }\n  }, {\n    key: 'setError',\n    value: function setError(name, error) {\n      var err = _typeof(this.state.error) === \"object\" ? this.state.error : {};\n\n      if (err[name] !== error) {\n        err[name] = error;\n        console.log(\"State errro\", name, error);\n        this.setState({\n          error: err\n        });\n      }\n    }\n  }, {\n    key: 'clearError',\n    value: function clearError(name) {\n      if (_typeof(this.state.error) === \"object\") {\n        if (this.state.error.hasOwnProperty(name)) {\n          delete this.state.error[name];\n          this.setState({\n            error: this.state.error\n          });\n        }\n      }\n    }\n  }]);\n\n  return Form;\n}(_react2.default.Component);\n\nForm.Fieldset = _Fieldset2.default;\nForm.DefaultInput = (0, _connectInput2.default)(Inputs.TextInput);\nForm.Inputs = {};\n\nfor (var n in Inputs) {\n  var inp = Inputs[n];\n\n  if (n.endsWith(\"Input\")) {\n    n = n.substring(0, n.length - 5);\n  }\n\n  Form.Inputs[n] = (0, _connectInput2.default)(inp);\n} // Overide this value to provide a custom input control based on a name\n\n\nForm.InputHook = undefined;\n\nvar Model = function Model(props, context) {\n  return _react2.default.createElement('div', props, generate(context.form.props.attributes, context.form.props.suppress));\n};\n\nModel.contextTypes = {\n  form: _react.PropTypes.object\n};\n/* Generate a form for the model */\n\nfunction generate(attributes, suppress) {\n  var inputs = [];\n\n  for (var i in attributes) {\n    var attr = attributes[i];\n\n    if (suppress && suppress.hasOwnProperty(attr.name)) {\n      continue;\n    }\n\n    inputs.push(_react2.default.createElement(_Input2.default, _extends({\n      key: attr.name\n    }, attr)));\n  }\n\n  return inputs;\n}\n\nForm.childContextTypes = {\n  form: _react.PropTypes.object\n};\nForm.propTypes = {\n  action: _react.PropTypes.string,\n\n  /* The url where the data needs to be posted */\n  method: _react.PropTypes.string,\n\n  /* The HTTP method for sending data */\n  attributes: _react.PropTypes.array,\n\n  /* The model attributes that can be automatically generated */\n  preset: _react.PropTypes.object,\n\n  /* The values to be used as default values for inputs */\n  suppress: _react.PropTypes.object,\n\n  /* The model attributes to be suppressed during automatic generation */\n  onSubmit: _react.PropTypes.func,\n\n  /* Override default onSubmit. The data posting will not take place. */\n  onValidate: _react.PropTypes.func,\n\n  /* A validation method that can validate/change the data before submission. Should throw ValidationError. */\n  onSuccess: _react.PropTypes.func,\n\n  /* Callback invoked once the data is submitted successfully to the server */\n  onError: _react.PropTypes.func\n  /* Callback invoked when the data could not be submitted to the server */\n\n};\nForm.connect = _connectInput2.default;\nexports.Model = Model;\nexports.default = Form;","map":{"version":3,"sources":["C:/xampp/htdocs/Laravel-React/rea/node_modules/react-bootstrap-form/lib/Form.js"],"names":["Object","defineProperty","exports","value","Model","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_typeof","Symbol","iterator","obj","constructor","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_Fieldset","_Fieldset2","_inputs","Inputs","_interopRequireWildcard","_connectInput","_connectInput2","_ValidationError","_ValidationError2","_Input","_Input2","__esModule","newObj","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","Form","_React$Component","context","_this","getPrototypeOf","inputs","state","preset","suppress","error","componentWillReceiveProps","nextProps","setState","getChildContext","form","serialize","res","names","promises","inp","elem","push","getValue","Promise","all","then","values","map","val","index","validate","forEach","render","children","generate","attributes","createElement","Fieldset","label","className","type","onClick","_onSubmit","bind","onSubmit","e","_this2","preventDefault","actionUrl","action","method","xhr","XMLHttpRequest","open","onload","response","getResponseHeader","startsWith","JSON","parse","status","onSuccess","_handleError","statusText","onerror","stringify","send","catch","err","setError","name","message","console","msg","data","getDefaultValue","registerInput","element","unregisterInput","getError","log","clearError","Component","DefaultInput","TextInput","n","endsWith","substring","InputHook","contextTypes","PropTypes","object","attr","childContextTypes","propTypes","string","array","func","onValidate","onError","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Model = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _Fieldset = require('./Fieldset');\n\nvar _Fieldset2 = _interopRequireDefault(_Fieldset);\n\nvar _inputs = require('./inputs');\n\nvar Inputs = _interopRequireWildcard(_inputs);\n\nvar _connectInput = require('./connectInput');\n\nvar _connectInput2 = _interopRequireDefault(_connectInput);\n\nvar _ValidationError = require('./ValidationError');\n\nvar _ValidationError2 = _interopRequireDefault(_ValidationError);\n\nvar _Input = require('./Input');\n\nvar _Input2 = _interopRequireDefault(_Input);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Form = function (_React$Component) {\n  _inherits(Form, _React$Component);\n\n  function Form(props, context) {\n    _classCallCheck(this, Form);\n\n    // A list of input elements available on this form\n    // populated through the context by the the child inputs\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Form).call(this, props, context));\n\n    _this.inputs = {};\n\n    _this.state = {\n      preset: Object.assign({}, _this.props.preset, _this.props.suppress),\n      error: false\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      this.setState({\n        preset: Object.assign({}, nextProps.preset, nextProps.suppress)\n      });\n    }\n  }, {\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        form: this\n      };\n    }\n\n    /** Get all the values of the input elements in the form \"asyncronously\"\n     * and also validates the value in the process\n     */\n\n  }, {\n    key: 'serialize',\n    value: function serialize() {\n      var res = Object.assign({}, this.state.preset);\n      var inputs = [];\n      var names = [];\n      var promises = [];\n      for (var inp in this.inputs) {\n        var elem = this.inputs[inp];\n        names.push(inp);\n        inputs.push(elem);\n        promises.push(elem.getValue());\n      }\n      return Promise.all(promises).then(function (values) {\n        var promises = values.map(function (val, index) {\n          return inputs[index].validate(val);\n        });\n        return Promise.all(promises).then(function (values) {\n          values.forEach(function (val, index) {\n            if (val !== undefined) {\n              res[names[index]] = val;\n            }\n          });\n\n          return res;\n        });\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n\n      var error = this.state.error;\n      if (!children) {\n        children = generate(this.props.attributes, this.props.suppress);\n        children.push(_react2.default.createElement(\n          Form.Fieldset,\n          { key: 'form__submit__', label: '' },\n          _react2.default.createElement(\n            'button',\n            { className: 'btn btn-sm btn-primary', type: 'submit', onClick: this._onSubmit.bind(this) },\n            'Save'\n          )\n        ));\n      }\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'form', onSubmit: this._onSubmit.bind(this) },\n        typeof error === \"string\" && _react2.default.createElement(\n          'div',\n          { className: '.alert-danger' },\n          error\n        ),\n        children\n      );\n    }\n  }, {\n    key: '_onSubmit',\n    value: function _onSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n\n      var actionUrl = typeof this.props.action === \"function\" ? this.props.action(props) : this.props.action;\n      var method = this.props.method || (this.props.preset ? \"PUT\" : \"POST\"); // Automatically detect the form post method\n      this.serialize().then(function (res) {\n        var xhr = new XMLHttpRequest();\n        xhr.open(method, actionUrl);\n        xhr.onload = function () {\n          var response = xhr.response;\n          // Parsing the JSON type data, checking with startsWith, as charset may also be available\n          // TODO: A good content type parser with charsets need to be implemented\n          if (xhr.getResponseHeader('content-type').startsWith(\"application/json\")) {\n            response = JSON.parse(response);\n          }\n          if (xhr.status >= 200 && xhr.status < 300) {\n            _this2.props.onSuccess && _this2.props.onSuccess(response);\n          } else if (xhr.status >= 400 && xhr.status < 500) {\n            _this2._handleError(\"Invalid server configuration. The resource could not be found.\", response);\n          } else if (xhr.status >= 500 && xhr.status < 600) {\n            _this2._handleError(\"Invalid input data\", response);\n          } else {\n            _this2._handleError(\"Unknown error. Please contact system administrator. \" + xhr.status + \"::\" + xhr.statusText, response);\n          }\n        };\n        xhr.onerror = function () {\n          return _this2._handleError(\"Network error\", null);\n        };\n\n        if ((typeof res === 'undefined' ? 'undefined' : _typeof(res)) === \"object\") {\n          res = JSON.stringify(res);\n        }\n\n        xhr.send(res);\n      }).catch(function (err) {\n        if (err instanceof _ValidationError2.default) {\n          _this2.setError(err.name, err.message);\n        } else {\n          console.error(\"Unknown Error\", err);\n          _this2.setState({\n            error: \"Unknown error\"\n          });\n        }\n      });\n    }\n  }, {\n    key: '_handleError',\n    value: function _handleError(msg, data) {\n      this.setState({\n        error: msg\n      });\n    }\n  }, {\n    key: 'getDefaultValue',\n    value: function getDefaultValue(name) {\n      return this.props.preset && this.props.preset[name];\n    }\n  }, {\n    key: 'registerInput',\n    value: function registerInput(name, element) {\n      // The name should not be registered more than once\n      if (this.inputs.hasOwnProperty(name)) {\n        console.error(\"A form input with name '\" + name + \"' is already registered.\" + \" The element you are trying to register is not going to be registered.\" + \" There shouldn't be more than one input element with the same name. In \" + \" case you are using a checkbox or a radio button make sure you incapsulate \" + \" them in a parent component and use that parent component as the input element.\");\n      } else {\n        this.inputs[name] = element;\n      }\n    }\n  }, {\n    key: 'unregisterInput',\n    value: function unregisterInput(name, element) {\n      // Unregister only if the name and element matches, trying to avoid\n      // same name regsitration error problem\n      if (this.inputs[name] === element) {\n        delete this.inputs[name];\n      }\n    }\n  }, {\n    key: 'getError',\n    value: function getError(name) {\n      return _typeof(this.state.error) === \"object\" && this.state.error[name];\n    }\n  }, {\n    key: 'setError',\n    value: function setError(name, error) {\n      var err = _typeof(this.state.error) === \"object\" ? this.state.error : {};\n      if (err[name] !== error) {\n        err[name] = error;\n        console.log(\"State errro\", name, error);\n        this.setState({\n          error: err\n        });\n      }\n    }\n  }, {\n    key: 'clearError',\n    value: function clearError(name) {\n      if (_typeof(this.state.error) === \"object\") {\n        if (this.state.error.hasOwnProperty(name)) {\n          delete this.state.error[name];\n          this.setState({\n            error: this.state.error\n          });\n        }\n      }\n    }\n  }]);\n\n  return Form;\n}(_react2.default.Component);\n\nForm.Fieldset = _Fieldset2.default;\nForm.DefaultInput = (0, _connectInput2.default)(Inputs.TextInput);\n\nForm.Inputs = {};\nfor (var n in Inputs) {\n  var inp = Inputs[n];\n  if (n.endsWith(\"Input\")) {\n    n = n.substring(0, n.length - 5);\n  }\n  Form.Inputs[n] = (0, _connectInput2.default)(inp);\n}\n\n// Overide this value to provide a custom input control based on a name\nForm.InputHook = undefined;\n\nvar Model = function Model(props, context) {\n  return _react2.default.createElement(\n    'div',\n    props,\n    generate(context.form.props.attributes, context.form.props.suppress)\n  );\n};\n\nModel.contextTypes = {\n  form: _react.PropTypes.object\n};\n\n/* Generate a form for the model */\nfunction generate(attributes, suppress) {\n  var inputs = [];\n  for (var i in attributes) {\n    var attr = attributes[i];\n    if (suppress && suppress.hasOwnProperty(attr.name)) {\n      continue;\n    }\n\n    inputs.push(_react2.default.createElement(_Input2.default, _extends({ key: attr.name }, attr)));\n  }\n\n  return inputs;\n}\n\nForm.childContextTypes = {\n  form: _react.PropTypes.object\n};\n\nForm.propTypes = {\n  action: _react.PropTypes.string, /* The url where the data needs to be posted */\n  method: _react.PropTypes.string, /* The HTTP method for sending data */\n\n  attributes: _react.PropTypes.array, /* The model attributes that can be automatically generated */\n  preset: _react.PropTypes.object, /* The values to be used as default values for inputs */\n  suppress: _react.PropTypes.object, /* The model attributes to be suppressed during automatic generation */\n\n  onSubmit: _react.PropTypes.func, /* Override default onSubmit. The data posting will not take place. */\n  onValidate: _react.PropTypes.func, /* A validation method that can validate/change the data before submission. Should throw ValidationError. */\n  onSuccess: _react.PropTypes.func, /* Callback invoked once the data is submitted successfully to the server */\n  onError: _react.PropTypes.func /* Callback invoked when the data could not be submitted to the server */\n};\n\nForm.connect = _connectInput2.default;\n\nexports.Model = Model;\nexports.default = Form;"]},"metadata":{},"sourceType":"script"}